{{- $site := .Site }}
{{- $section := .section }}
{{- $bg := $section.design.background }}
{{- $style := "" }}

{{- if $bg.color }}
{{- $style = printf "background-color: %s;" ($bg.color | default "transparent") }}
{{- end }}

{{- if and $bg.gradient_start $bg.gradient_end }}
{{- $style = printf "%sbackground-image: linear-gradient(%s, %s);" $style $bg.gradient_start $bg.gradient_end }}
{{- end }}

{{- if $bg.image }}
{{- $darken := "" }}
{{- if $bg.image_darken }}
{{- $darken = printf "linear-gradient(rgba(0, 0, 0, %s), rgba(0, 0, 0, %s))," (string $bg.image_darken) (string $bg.image_darken) }}
{{- end }}

{{- $style = printf "%sbackground-image: %s url('%s');" $style $darken (printf "img/%s" $bg.image | absURL) }}
{{- with $bg.image_size }}
{{/* Allow sizes: actual, cover, and contain. */}}
{{- $style = printf "%sbackground-size: %s;" $style (replace . "actual" "auto") }}
{{- end }}
{{- with $bg.image_position }}
{{/* Allow valid CSS positions including left, center, and right. */}}
{{- $style = printf "%sbackground-position: %s;" $style . }}
{{- end }}
{{- end }}

{{- with $section.design.spacing.padding }}
{{- $style_padding := printf "padding: %s;" (delimit . " ") }}
{{- $style = print $style $style_padding }}
{{- end }}

<div class="banner__image relative overflow-hidden transition-all duration-500 ease-ease" {{with $style}}style="{{ . | safeCSS}}"{{end}}>
    <div class="relative aspect-w-16 aspect-h-9">
        {{ with $bg.image }}
        {{ with $bg.image }}
        {{ $include_dict_16_9 := dict "image" .  }}
        {{ partial "functions/get_image.html" $include_dict_16_9 }}
        {{ end }}
        {{ end }}
        <div class="absolute w-full h-full left-0 top-0 flex items-end z-30">
            <header class="banner__header lg:w-1/2 relative px-3 lg:px-6 py-8 after:empty-content after:absolute after:w-12 after:h-2px after:bg-primary after:transition after:duration-500 after:ease-out">
                {{- with $section.title }}
                <h2 class="text-primary font-semibold text-base lg:text-xl uppercase leading-none mb-2">{{ . | safeHTML }}</h2>
                {{- end }}
                {{- with $section.subtitle }}
                <h4 class="text-secondary text-sm font-medium font-body leading-none mb-3">{{ . | safeHTML }}</h4>
                {{- end }}
            </header>
        </div>
    </div>
</div>
